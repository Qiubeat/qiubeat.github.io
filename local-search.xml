<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>重置GitLab pull mirror功能</title>
    <link href="/2023/09/13/GitLab/%E9%87%8D%E7%BD%AEGitLab%20pull%20mirror/"/>
    <url>/2023/09/13/GitLab/%E9%87%8D%E7%BD%AEGitLab%20pull%20mirror/</url>
    
    <content type="html"><![CDATA[<p>网络出现一段问题，导致 <code>gitlab</code> 的 <code>pull mirror</code> 功能超过了 <code>最大重试次数</code>，进入了暂停 pull mirror 的状态。重置多个项目的 <code>pull mirror</code> 功能，如下：</p><ul><li>进入 <code>gitlab-rails console</code></li></ul><blockquote><p>$ docker exec -it gitlab bash</p></blockquote><blockquote><p>$ gitlab-rails console</p></blockquote><ul><li>执行以下命令</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><br><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Project</span>.</span></span>find_each <span class="hljs-keyword">do</span> <span class="hljs-pattern-match">|p|</span><br><span class="hljs-pattern-match"></span><br><span class="hljs-pattern-match"><span class="hljs-keyword">if</span> p.import<span class="hljs-constructor">_state</span> <span class="hljs-operator">&amp;&amp;</span> p.import<span class="hljs-constructor">_state</span>.retry<span class="hljs-constructor">_count</span> &gt;= 14</span><br><span class="hljs-pattern-match"></span><br><span class="hljs-pattern-match">puts &quot;<span class="hljs-constructor">Resetting</span> mirroring operation <span class="hljs-keyword">for</span> #&#123;p.full<span class="hljs-constructor">_path</span>&#125;&quot;</span><br><span class="hljs-pattern-match"></span><br><span class="hljs-pattern-match">p.import<span class="hljs-constructor">_state</span>.reset<span class="hljs-constructor">_retry_count</span></span><br><span class="hljs-pattern-match"></span><br><span class="hljs-pattern-match">p.import<span class="hljs-constructor">_state</span>.set<span class="hljs-constructor">_next_execution_to_now(<span class="hljs-params">prioritized</span>: <span class="hljs-params">true</span>)</span></span><br><span class="hljs-pattern-match"></span><br><span class="hljs-pattern-match">p.import<span class="hljs-constructor">_state</span>.save!</span><br><span class="hljs-pattern-match"></span><br><span class="hljs-pattern-match"><span class="hljs-keyword">end</span></span><br><span class="hljs-pattern-match"></span><br><span class="hljs-pattern-match"><span class="hljs-keyword">end</span></span><br><span class="hljs-pattern-match"></span><br></code></pre></td></tr></table></figure><blockquote><p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p></blockquote><!--stackedit_data:eyJoaXN0b3J5IjpbLTE3MTM2NTY1MTddfQ==-->]]></content>
    
    
    
    <tags>
      
      <tag>GitLab</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>initializer is inaccessible due to &#39;private&#39; protection level</title>
    <link href="/2023/09/13/%E5%AD%A6%E8%89%BA%E4%B8%8D%E7%B2%BE/initializer%20is%20inaccessible%20due%20to%20&#39;private&#39;%20protection%20level.md/"/>
    <url>/2023/09/13/%E5%AD%A6%E8%89%BA%E4%B8%8D%E7%B2%BE/initializer%20is%20inaccessible%20due%20to%20&#39;private&#39;%20protection%20level.md/</url>
    
    <content type="html"><![CDATA[<p><a href="https://forums.swift.org/t/initializer-is-inaccessible-due-to-private-protection-level/54808">From Swift Forums</a></p><p>复现代码：</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyStruct</span> &#123;<br><span class="hljs-keyword">var</span> fruit: <span class="hljs-type">String</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> animal: <span class="hljs-type">String</span>?<br><br><span class="hljs-keyword">func</span> <span class="hljs-title function_">setAnimal</span>(<span class="hljs-params">animal</span>: <span class="hljs-type">String</span>) &#123;<br><span class="hljs-keyword">self</span>.animal <span class="hljs-operator">=</span> animal<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Variety</span> &#123;<br><span class="hljs-keyword">var</span> my: <span class="hljs-type">MyStruct</span> <span class="hljs-operator">=</span> <span class="hljs-type">MyStruct</span>(fruit: <span class="hljs-string">&quot;apple&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>问题原因：<br>调用 <code>MyStruct</code> 在初始化成员时是最终会转化为 <code>init(fruit: String, animal: String?)</code> ，而<code>animal</code> 是 <code>private</code> 类型，<code>MyStruct</code> 外部访问不到 <code>animal</code> 属性，所以会报错。</p><p>解决方案：</p><ol><li>删掉 <code>private</code></li><li><code>private var</code> 换成 <code>private let</code> ，但是<code>private let</code> 的变量只能初始化一次，后续不可更改。</li></ol><blockquote><p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p></blockquote><!--stackedit_data:eyJoaXN0b3J5IjpbLTM0NTA2ODgxMF19-->]]></content>
    
    
    <categories>
      
      <category>学艺不精</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Swift</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
